{
  "openapi": "3.0.0",
  "info": {
    "title": "SisAcad API",
    "description": "API para el Sistema Académico (SisAcad)",
    "version": "0.0.1"
  },
  "servers": [
    {
      "url": "/api",
      "description": "Servidor de desarrollo"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "Se requiere un token JWT obtenido de la ruta /auth/login."
      }
    },
    "parameters": {
      "semesterParam": {
        "name": "semester",
        "in": "path",
        "required": true,
        "description": "Semestre académico (ej. 2024-I).",
        "schema": {
          "type": "string",
          "pattern": "^\\d{4}-(I{1,2})$",
          "example": "2024-I"
        }
      },
      "enrollmentIdParam": {
        "name": "enrollmentId",
        "in": "path",
        "required": true,
        "description": "ID de la matrícula de teoría (enrollment).",
        "schema": {
          "type": "string",
          "format": "uuid",
          "example": "00000000-0009-4000-8000-000000000001"
        }
      },
      "groupIdParam": {
        "name": "groupId",
        "in": "path",
        "required": true,
        "description": "ID del grupo (TheoryGroup o LabGroup).",
        "schema": {
          "type": "string",
          "format": "uuid",
          "example": "00000000-0006-4000-8000-000000000001"
        }
      },
      "classTypeQuery": {
        "name": "type",
        "in": "query",
        "required": true,
        "description": "Especifica si el ID es de 'teoria' o 'labo'.",
        "schema": {
          "$ref": "#/components/schemas/ClassType",
          "example": "teoria"
        }
      }
    },
    "schemas": {
      "AttendanceStatus": {
        "type": "string",
        "enum": [
          "presente",
          "ausente"
        ],
        "description": "Estado de la asistencia."
      },
      "AvailableLabGroup": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0007-4000-8000-000000000001"
          },
          "groupLetter": {
            "type": "string",
            "example": "A"
          },
          "capacity": {
            "type": "integer",
            "example": 20
          },
          "currentEnrollment": {
            "type": "integer",
            "example": 0
          },
          "isFull": {
            "type": "boolean",
            "example": false
          }
        },
        "description": "DTO para un grupo de laboratorio disponible."
      },
      "BulkGradeSaveEntry": {
        "type": "object",
        "required": [
          "enrollmentId",
          "type",
          "score"
        ],
        "properties": {
          "enrollmentId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0009-4000-8000-000000000001"
          },
          "type": {
            "$ref": "#/components/schemas/GradeType",
            "example": "parcial_2"
          },
          "score": {
            "type": "number",
            "minimum": 0,
            "maximum": 20,
            "example": 14.5
          }
        },
        "description": "Entrada individual de guardado de nota."
      },
      "ClassType": {
        "type": "string",
        "enum": [
          "teoria",
          "labo"
        ],
        "description": "Tipo de clase (teoría o laboratorio)."
      },
      "CourseStatus": {
        "type": "string",
        "enum": [
          "Aprobado",
          "Desaprobado",
          "En Progreso"
        ],
        "description": "Estado del curso basado en el promedio."
      },
      "CreateReservationInput": {
        "type": "object",
        "required": [
          "classroomId",
          "semester",
          "date",
          "startTime",
          "endTime"
        ],
        "properties": {
          "classroomId": {
            "type": "string",
            "format": "uuid",
            "description": "ID del aula que se desea reservar."
          },
          "semester": {
            "type": "string",
            "pattern": "^\\d{4}-(I|II)$",
            "description": "Semestre para el cual se hace la reserva.",
            "example": "2024-I"
          },
          "date": {
            "type": "string",
            "format": "date",
            "description": "Fecha de la reserva en formato YYYY-MM-DD.",
            "example": "2024-11-20"
          },
          "startTime": {
            "type": "string",
            "format": "time",
            "description": "Hora de inicio en formato HH:MM (24h).",
            "example": "14:00"
          },
          "endTime": {
            "type": "string",
            "format": "time",
            "description": "Hora de fin en formato HH:MM (24h).",
            "example": "15:50"
          },
          "notes": {
            "type": "string",
            "maxLength": 500,
            "description": "Notas opcionales sobre la reserva.",
            "example": "Clase de repaso para Parcial 2"
          }
        },
        "description": "Datos de entrada para crear una nueva reserva de aula."
      },
      "DayOfWeek": {
        "type": "string",
        "enum": [
          "LUNES",
          "MARTES",
          "MIERCOLES",
          "JUEVES",
          "VIERNES",
          "SABADO",
          "DOMINGO"
        ],
        "description": "Día de la semana."
      },
      "EnrollInLabGroupInput": {
        "type": "object",
        "required": [
          "enrollmentId",
          "labGroupId"
        ],
        "properties": {
          "enrollmentId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0009-4000-8000-000000000001"
          },
          "labGroupId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0007-4000-8000-000000000001"
          }
        },
        "description": "Body para matricularse en un solo grupo de laboratorio."
      },
      "EnrollInLabGroupsInput": {
        "type": "object",
        "required": [
          "selections"
        ],
        "properties": {
          "selections": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LabEnrollmentSelection"
            },
            "minItems": 1
          }
        },
        "description": "Body para matrícula masiva en laboratorios."
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "ValidationError"
          },
          "message": {
            "type": "string",
            "example": "Invalid request data."
          },
          "details": {
            "type": "object",
            "description": "Detalles del error de validación (opcional)."
          }
        }
      },
      "GradeOutput": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-000a-4000-8000-000000000001"
          },
          "type": {
            "$ref": "#/components/schemas/GradeType",
            "example": "parcial_1"
          },
          "typeName": {
            "type": "string",
            "example": "Parcial 1"
          },
          "score": {
            "type": "number",
            "format": "float",
            "minimum": 0,
            "maximum": 20,
            "example": 15
          }
        },
        "description": "DTO para una nota individual."
      },
      "GradeType": {
        "type": "string",
        "enum": [
          "parcial_1",
          "parcial_2",
          "parcial_3",
          "continua_1",
          "continua_2",
          "continua_3"
        ],
        "description": "Tipo de evaluación."
      },
      "LabEnrollmentSelection": {
        "type": "object",
        "required": [
          "enrollmentId",
          "labGroupId"
        ],
        "properties": {
          "enrollmentId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0009-4000-8000-000000000001"
          },
          "labGroupId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0007-4000-8000-000000000001"
          }
        },
        "description": "Selección individual para matrícula masiva."
      },
      "LabEnrollmentStatus": {
        "type": "string",
        "enum": [
          "Matriculado",
          "Sin Matricula",
          "N/A"
        ],
        "description": "Estado de matrícula en laboratorio."
      },
      "LoginInput": {
        "type": "object",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "example": "atorresa@unsa.edu.pe"
          },
          "password": {
            "type": "string",
            "format": "password",
            "minLength": 10,
            "example": "password123"
          }
        },
        "description": "Credenciales para iniciar sesión.",
        "examples": {
          "studentLogin": {
            "summary": "Login de Estudiante",
            "value": {
              "email": "atorresa@unsa.edu.pe",
              "password": "password123"
            }
          },
          "teacherLogin": {
            "summary": "Login de Profesor",
            "value": {
              "email": "wramos@unsa.edu.pe",
              "password": "password123"
            }
          }
        }
      },
      "LoginOutput": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "description": "Token JWT para autenticación.",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIwMDAwMDAwMC0wMDAxLTQwMDAtODAwMC0wMDAwMDAwMDAwMTAiLCJyb2xlIjoiZXN0dWRpYW50ZSIsInByb2ZpbGVJZCI6IjAwMDAwMDAwLTAwMDMtNDAwMC04MDAwLTAwMDAwMDAwMDAwMSIsImlhdCI6MTc2MjI0MzIwMCwiZXhwIjoxNzYyMjQ2ODAwfQ.ejm..."
          },
          "role": {
            "$ref": "#/components/schemas/UserRole"
          },
          "profileId": {
            "type": "string",
            "format": "uuid",
            "description": "ID del perfil de estudiante o profesor asociado.",
            "example": "00000000-0003-4000-8000-000000000001"
          }
        },
        "description": "Respuesta exitosa de inicio de sesión."
      },
      "ReservationStatus": {
        "type": "string",
        "enum": [
          "reservado",
          "free",
          "completado"
        ],
        "description": "Estado de la reserva de aula."
      },
      "RoomReservationOutput": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "classroomId": {
            "type": "string",
            "format": "uuid"
          },
          "professorId": {
            "type": "string",
            "format": "uuid"
          },
          "semester": {
            "type": "string",
            "example": "2024-I"
          },
          "date": {
            "type": "string",
            "format": "date",
            "example": "2024-11-20"
          },
          "startTime": {
            "type": "string",
            "format": "time",
            "example": "14:00"
          },
          "endTime": {
            "type": "string",
            "format": "time",
            "example": "15:50"
          },
          "status": {
            "$ref": "#/components/schemas/ReservationStatus"
          },
          "notes": {
            "type": "string",
            "nullable": true
          }
        },
        "description": "DTO que representa una reserva de aula ya creada."
      },
      "SaveBulkGradesInput": {
        "type": "object",
        "required": [
          "classType",
          "groupId",
          "entries"
        ],
        "properties": {
          "classType": {
            "$ref": "#/components/schemas/ClassType"
          },
          "groupId": {
            "type": "string",
            "format": "uuid"
          },
          "entries": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkGradeSaveEntry"
            }
          }
        },
        "description": "Body para guardado masivo de notas.",
        "example": {
          "classType": "teoria",
          "groupId": "00000000-0006-4000-8000-000000000001",
          "entries": [
            {
              "enrollmentId": "00000000-0009-4000-8000-000000000001",
              "type": "parcial_2",
              "score": 14
            },
            {
              "enrollmentId": "00000000-0009-4000-8000-000000000007",
              "type": "parcial_2",
              "score": 11.5
            }
          ]
        }
      },
      "StudentCourse": {
        "type": "object",
        "properties": {
          "enrollmentId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0009-4000-8000-000000000001"
          },
          "courseCode": {
            "type": "string",
            "example": "01703239"
          },
          "courseName": {
            "type": "string",
            "example": "SISTEMAS OPERATIVOS"
          },
          "credits": {
            "type": "integer",
            "example": 4
          },
          "professorName": {
            "type": "string",
            "example": "Wilber Roberto Ramos Lovon"
          },
          "labStatus": {
            "$ref": "#/components/schemas/LabEnrollmentStatus",
            "example": "Sin Matricula"
          }
        },
        "description": "DTO de un curso matriculado por el estudiante."
      },
      "StudentCourseGrades": {
        "type": "object",
        "properties": {
          "enrollmentId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0009-4000-8000-000000000001"
          },
          "courseName": {
            "type": "string",
            "example": "SISTEMAS OPERATIVOS"
          },
          "professorName": {
            "type": "string",
            "example": "Wilber Roberto Ramos Lovon"
          },
          "grades": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/GradeOutput"
            }
          },
          "average": {
            "type": "number",
            "format": "float",
            "nullable": true,
            "example": 5.1
          },
          "status": {
            "$ref": "#/components/schemas/CourseStatus",
            "example": "En Progreso"
          }
        },
        "description": "Resumen de notas de un estudiante para un curso."
      },
      "StudentGradeEntry": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/GradeType"
          },
          "score": {
            "type": "number",
            "format": "float",
            "nullable": true,
            "example": 15.5
          }
        },
        "description": "Celda de nota individual en la grilla."
      },
      "StudentRoster": {
        "type": "object",
        "properties": {
          "enrollmentId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0009-4000-8000-000000000001"
          },
          "studentCode": {
            "type": "string",
            "example": "20233585"
          },
          "name": {
            "type": "string",
            "example": "Alvaro Sebastian"
          },
          "surname": {
            "type": "string",
            "example": "Torres Ara"
          },
          "email": {
            "type": "string",
            "format": "email",
            "example": "atorresa@unsa.edu.pe"
          }
        },
        "description": "Información de un estudiante en la lista de un grupo."
      },
      "StudentRosterWithGrades": {
        "type": "object",
        "properties": {
          "enrollmentId": {
            "type": "string",
            "format": "uuid"
          },
          "studentCode": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "surname": {
            "type": "string"
          },
          "email": {
            "type": "string",
            "format": "email"
          },
          "grades": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/StudentGradeEntry"
            }
          }
        },
        "description": "Estudiante en la lista con todas sus notas.",
        "example": {
          "enrollmentId": "00000000-0009-4000-8000-000000000001",
          "studentCode": "20233585",
          "name": "Alvaro Sebastian",
          "surname": "Torres Ara",
          "email": "atorresa@unsa.edu.pe",
          "grades": [
            {
              "type": "parcial_1",
              "score": 15
            },
            {
              "type": "parcial_2",
              "score": null
            },
            {
              "type": "parcial_3",
              "score": null
            },
            {
              "type": "continua_1",
              "score": 18
            },
            {
              "type": "continua_2",
              "score": null
            },
            {
              "type": "continua_3",
              "score": null
            }
          ]
        }
      },
      "StudentScheduleEntry": {
        "type": "object",
        "properties": {
          "courseName": {
            "type": "string",
            "example": "SISTEMAS OPERATIVOS"
          },
          "groupType": {
            "type": "string",
            "enum": [
              "Teoria",
              "Lab"
            ],
            "example": "Teoria"
          },
          "groupLetter": {
            "type": "string",
            "example": "A"
          },
          "day": {
            "$ref": "#/components/schemas/DayOfWeek",
            "example": "LUNES"
          },
          "startTime": {
            "type": "string",
            "format": "time",
            "example": "10:00"
          },
          "endTime": {
            "type": "string",
            "format": "time",
            "example": "10:50"
          },
          "classroomName": {
            "type": "string",
            "example": "Aula 101"
          },
          "professorName": {
            "type": "string",
            "example": "Wilber Roberto Ramos Lovon"
          }
        },
        "description": "Entrada individual del horario del estudiante."
      },
      "TakeAttendanceInput": {
        "type": "object",
        "required": [
          "classType",
          "groupId",
          "date",
          "records"
        ],
        "properties": {
          "classType": {
            "$ref": "#/components/schemas/ClassType"
          },
          "groupId": {
            "type": "string",
            "format": "uuid"
          },
          "date": {
            "type": "string",
            "format": "date",
            "example": "2024-05-27"
          },
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttendanceRecord"
            },
            "minItems": 1
          }
        },
        "description": "Body para tomar asistencia.",
        "example": {
          "classType": "teoria",
          "groupId": "00000000-0006-4000-8000-000000000001",
          "date": "2024-05-27",
          "records": [
            {
              "enrollmentId": "00000000-0009-4000-8000-000000000001",
              "status": "presente"
            },
            {
              "enrollmentId": "00000000-0009-4000-8000-000000000007",
              "status": "presente"
            },
            {
              "enrollmentId": "00000000-0009-4000-8000-000000000012",
              "status": "ausente"
            }
          ]
        }
      },
      "TeacherGroup": {
        "type": "object",
        "properties": {
          "groupId": {
            "type": "string",
            "format": "uuid",
            "example": "00000000-0006-4000-8000-000000000001"
          },
          "courseName": {
            "type": "string",
            "example": "SISTEMAS OPERATIVOS"
          },
          "groupType": {
            "$ref": "#/components/schemas/ClassType",
            "example": "teoria"
          },
          "groupLetter": {
            "type": "string",
            "example": "A"
          }
        },
        "description": "Un grupo (teoría o lab) asignado a un profesor."
      },
      "TeacherScheduleEntry": {
        "type": "object",
        "properties": {
          "courseName": {
            "type": "string",
            "example": "SISTEMAS OPERATIVOS"
          },
          "groupType": {
            "type": "string",
            "enum": [
              "Teoria",
              "Labo"
            ],
            "example": "Teoria"
          },
          "groupLetter": {
            "type": "string",
            "example": "A"
          },
          "day": {
            "$ref": "#/components/schemas/DayOfWeek",
            "example": "LUNES"
          },
          "startTime": {
            "type": "string",
            "format": "time",
            "example": "10:00"
          },
          "endTime": {
            "type": "string",
            "format": "time",
            "example": "10:50"
          },
          "classroomName": {
            "type": "string",
            "example": "Aula 101"
          }
        },
        "description": "Entrada individual del horario del profesor."
      },
      "UserRole": {
        "type": "string",
        "enum": [
          "administrador",
          "secretaria",
          "profesor",
          "estudiante"
        ],
        "description": "Rol del usuario en el sistema."
      }
    }
  },
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/auth/login": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Iniciar sesión",
        "description": "Autentica a un usuario y devuelve un token JWT. Esta ruta es pública.",
        "security": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginInput"
              },
              "examples": {
                "Student": {
                  "$ref": "#/components/schemas/LoginInput/examples/studentLogin"
                },
                "Teacher": {
                  "$ref": "#/components/schemas/LoginInput/examples/teacherLogin"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Autenticación exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginOutput"
                }
              }
            }
          },
          "400": {
            "description": "Error de validación (email o password inválido)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Credenciales incorrectas",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/student/courses/{semester}": {
      "get": {
        "tags": [
          "Student"
        ],
        "summary": "Obtener cursos matriculados",
        "description": "Obtiene la lista de cursos en los que el estudiante está matriculado para un semestre específico. Requiere rol 'estudiante'.",
        "parameters": [
          {
            "$ref": "#/components/parameters/semesterParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de cursos matriculados",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/StudentCourse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado (sin token)"
          },
          "403": {
            "description": "Forbidden (no es estudiante o no tiene perfil)"
          }
        }
      }
    },
    "/student/grades/{semester}": {
      "get": {
        "tags": [
          "Student"
        ],
        "summary": "Obtener notas del estudiante",
        "description": "Obtiene el resumen de notas del estudiante para todos los cursos de un semestre. Requiere rol 'estudiante'.",
        "parameters": [
          {
            "$ref": "#/components/parameters/semesterParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Resumen de notas por curso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/StudentCourseGrades"
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/student/schedule/{semester}": {
      "get": {
        "tags": [
          "Student"
        ],
        "summary": "Obtener horario del estudiante",
        "description": "Obtiene el horario de clases (teoría y laboratorio) del estudiante para un semestre. Requiere rol 'estudiante'.",
        "parameters": [
          {
            "$ref": "#/components/parameters/semesterParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de entradas de horario",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/StudentScheduleEntry"
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/student/enrollment/{enrollmentId}/available-labs": {
      "get": {
        "tags": [
          "Student"
        ],
        "summary": "Obtener laboratorios disponibles",
        "description": "Obtiene los grupos de laboratorio disponibles (no llenos) para una matrícula de teoría específica. Requiere rol 'estudiante'.",
        "parameters": [
          {
            "$ref": "#/components/parameters/enrollmentIdParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de laboratorios disponibles",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AvailableLabGroup"
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden (ej. no es dueño de la matrícula)"
          },
          "404": {
            "description": "Matrícula (enrollment) no encontrada"
          }
        }
      }
    },
    "/student/enroll-labs": {
      "post": {
        "tags": [
          "Student"
        ],
        "summary": "Matrícula masiva en laboratorios",
        "description": "Matricula al estudiante en múltiples grupos de laboratorio de forma transaccional. Requiere rol 'estudiante'.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EnrollInLabGroupsInput"
              },
              "example": {
                "selections": [
                  {
                    "enrollmentId": "00000000-0009-4000-8000-000000000001",
                    "labGroupId": "00000000-0007-4000-8000-000000000001"
                  },
                  {
                    "enrollmentId": "00000000-0009-4000-8000-000000000002",
                    "labGroupId": "00000000-0007-4000-8000-000000000003"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Matrícula exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden"
          },
          "409": {
            "description": "Conflicto (ej. grupo lleno, ya matriculado, error masivo)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/student/enroll-lab": {
      "patch": {
        "tags": [
          "Student"
        ],
        "summary": "Matrícula en un laboratorio (singular)",
        "description": "Matricula al estudiante en un solo grupo de laboratorio. Requiere rol 'estudiante'.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EnrollInLabGroupInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Matrícula exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden"
          },
          "409": {
            "description": "Conflicto (ej. grupo lleno, ya matriculado)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/teacher/groups/{semester}": {
      "get": {
        "tags": [
          "Teacher"
        ],
        "summary": "Obtener grupos del profesor",
        "description": "Obtiene todos los grupos (teoría y lab) asignados al profesor en un semestre. Requiere rol 'profesor'.",
        "parameters": [
          {
            "$ref": "#/components/parameters/semesterParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de grupos asignados",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/TeacherGroup"
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden (no es profesor)"
          }
        }
      }
    },
    "/teacher/schedule/{semester}": {
      "get": {
        "tags": [
          "Teacher"
        ],
        "summary": "Obtener horario del profesor",
        "description": "Obtiene el horario de clases semanal del profesor para un semestre. Requiere rol 'profesor'.",
        "parameters": [
          {
            "$ref": "#/components/parameters/semesterParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de entradas de horario",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/TeacherScheduleEntry"
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/teacher/group/{groupId}/roster": {
      "get": {
        "tags": [
          "Teacher"
        ],
        "summary": "Obtener lista de estudiantes (Roster)",
        "description": "Obtiene la lista de estudiantes matriculados en un grupo (teoría o lab). Requiere rol 'profesor'.",
        "parameters": [
          {
            "$ref": "#/components/parameters/groupIdParam"
          },
          {
            "$ref": "#/components/parameters/classTypeQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de estudiantes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/StudentRoster"
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden (no es profesor de este grupo)"
          }
        }
      }
    },
    "/teacher/attendance/take": {
      "post": {
        "tags": [
          "Teacher"
        ],
        "summary": "Tomar asistencia",
        "description": "Registra o actualiza la asistencia para múltiples estudiantes en una sesión. Es transaccional. Requiere rol 'profesor'.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TakeAttendanceInput"
              },
              "examples": {
                "takeAttendanceExample": {
                  "$ref": "#/components/schemas/TakeAttendanceInput/example"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Asistencia guardada",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Error de validación o error de dominio (ej. fecha futura)"
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden (no es profesor del grupo)"
          }
        }
      }
    },
    "/teacher/group/{groupId}/roster-with-grades": {
      "get": {
        "tags": [
          "Teacher"
        ],
        "summary": "Obtener lista con notas",
        "description": "Obtiene la lista de estudiantes con sus notas para la grilla de calificaciones. Requiere rol 'profesor'.",
        "parameters": [
          {
            "$ref": "#/components/parameters/groupIdParam"
          },
          {
            "$ref": "#/components/parameters/classTypeQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de estudiantes con sus notas",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/StudentRosterWithGrades"
                  }
                }
              }
            }
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden (no es profesor de este grupo)"
          }
        }
      }
    },
    "/teacher/grades/save-bulk": {
      "post": {
        "tags": [
          "Teacher"
        ],
        "summary": "Guardar notas (masivo)",
        "description": "Guarda o actualiza un lote de notas. Es transaccional. Requiere rol 'profesor'.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SaveBulkGradesInput"
              },
              "examples": {
                "saveGradesExample": {
                  "$ref": "#/components/schemas/SaveBulkGradesInput/example"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Notas guardadas",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "4G00": {
            "description": "Error de validación (ej. nota > 20)"
          },
          "401": {
            "description": "No autorizado"
          },
          "403": {
            "description": "Forbidden (no es profesor o la matrícula no pertenece al grupo)"
          }
        }
      }
    },
    "/teacher/reservations/create": {
      "post": {
        "tags": [
          "Teacher"
        ],
        "summary": "Crear una reserva de aula",
        "description": "Registra una reserva de aula para el profesor, validando conflictos y reglas de negocio (ej. límite semanal). Es transaccional. Requiere rol 'profesor'.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateReservationInput"
              },
              "example": {
                "classroomId": "00000000-0005-4000-8000-000000000004",
                "semester": "2024-I",
                "date": "2024-11-20",
                "startTime": "14:00",
                "endTime": "15:50",
                "notes": "Clase de repaso para Parcial 2"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Reserva creada exitosamente.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoomReservationOutput"
                }
              }
            }
          },
          "400": {
            "description": "Datos de solicitud inválidos (ej. formato de fecha incorrecto, endTime antes de startTime).",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No autorizado (sin token)"
          },
          "403": {
            "description": "Forbidden (no es profesor)"
          },
          "409": {
            "description": "Conflicto (ej. aula ya reservada, límite de reservas excedido, conflictos de horario).",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Health Check",
        "description": "Ruta pública para verificar el estado del servidor.",
        "security": [],
        "responses": {
          "200": {
            "description": "Servidor en línea",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "OK"
                    },
                    "time": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
